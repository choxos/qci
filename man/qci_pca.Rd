% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pca.R
\name{qci_pca}
\alias{qci_pca}
\title{Compute QCI scores via PCA}
\usage{
qci_pca(
  data,
  ratio_cols = c("MIR", "YLLtoYLD", "DALtoPER", "PERtoINC"),
  group_by = c("sex_name", "age_name"),
  ncp = 5,
  scale.unit = TRUE
)
}
\arguments{
\item{data}{A data.table with the four ratio columns (\code{MIR}, \code{YLLtoYLD},
\code{DALtoPER}, \code{PERtoINC}) plus grouping columns \code{sex_name} and \code{age_name}.
Typically the output of \code{\link[=qci_ratios]{qci_ratios()}}.}

\item{ratio_cols}{Character vector of column names for PCA input.
Default \code{c("MIR", "YLLtoYLD", "DALtoPER", "PERtoINC")}.}

\item{group_by}{Character vector of columns to stratify PCA by.
Default \code{c("sex_name", "age_name")}.}

\item{ncp}{Integer. Number of principal components to compute.
Default \code{5} (FactoMineR default). Only PC1 is used for QCI.}

\item{scale.unit}{Logical. Whether to scale variables to unit variance
before PCA. Default \code{TRUE}.}
}
\value{
A list with two elements:
\describe{
\item{data}{The input data.table with a new \code{qci_score} column
containing the 0-100 inverted PCA score.}
\item{pca_details}{A data.frame with one row per subgroup, containing
columns: sex_name, age_name, variance_explained_pc1, eigenvalue_pc1,
n_observations.}
}
}
\description{
Runs Principal Component Analysis on the four QCI ratios, stratified
by sex and age subgroups. Extracts PC1, normalizes to 0-100, then
inverts (\code{100 - score}) so that higher values indicate better quality
of care.
}
\examples{
data(sample_gbd)
cleaned <- qci_clean(sample_gbd)
with_ratios <- qci_ratios(cleaned$wide_number)
result <- qci_pca(with_ratios)
head(result$data[, .(location_name, year, sex_name, qci_score)])
}
